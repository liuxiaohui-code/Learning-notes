# 文本



## 文本查看-cat
用于连接并显示指定的一个和多个文件的有关信息
cat命令在其输入上接受一个或多个文件，并将它们作为一个单独的文件打印到它的输出。
```sh
cat [options] 文件1 文件2……

-n # 显示行号
-b     #和-n相似，只不过对于空白行不编号。
-s     #当遇到有连续两行以上的空白行时，就代换为一行的空白行。
```

## 文本查看与过滤-grep

```sh
# Global Regular Expression Print，表示全局正则表达式版本

grep [option] {关键字} {file}
# 关键字可以正则表达式 ^开头*结尾$
--color=tty  #  关键字彩色显示
-v	# 不包括的几行（取反）
-n 	# 行号
-c #只输出匹配行的计数。
-I #不区分大小写（只适用于单字符）。
-h #查询多文件时不显示文件名。
-l #查询多文件时只输出包含匹配字符的文件名。
```

## 文本查看与翻页-more

```sh
more {flie}

#空格翻页 回车换行
```

## 文本查看与翻页-less

上下键翻页 可以反复看（可以回翻页）

## 查看前几行-head

```sh
head -{num} {file}
# 查看前9行
head -9 1.txt
```

## 文本查看与滚动更新-tail

```sh
# 查看最新的200行并滚动更新
tail -n 200 -f xxx.log
```

## 文本文件插入替换-sed

```js
// 1. 替换 's/Search_String/Replacement_String/g'
// 将每一行第一个 a 替换为 b
sed -i 's/a/b/' demo.txt
// 将每一行所有的 a 替换为 b
sed -i 's/a/b/g' demo.txt
// 将每一行所有的 a 替换为 b,并把结果在打印一次
sed -i 's/a/b/pg' demo.txt
// 将每一行第 2 个及以后的 a 替换为 b
sed -i 's/a/b/2g' demo.txt
// 将第一行所有的 a 替换为 b
sed -i '1s/a/b/g' demo.txt
// 将第一行到第三行所有的 a 替换为 b
sed -i '1,3s/a/b/g' demo.txt
// 将最后一行所有的 a 替换为 b
sed -i '$s/a/b/g' demo.txt
// 将包含 str 的行所有的 a 替换为 b
sed -i '/str/ s/a/b/g' demo.txt

// 2. 替换整行
// 将第二行内容替换为xxxxx
sed -i '2 c xxxxx ' demo.txt
sed -i '2s/.*/xxxxx/ ' demo.txt // .* 整行
sed -i '2s/./xxxxx/g ' demo.txt // . 此行每一个字符

// 3. 替换单个字符,查找的各个字符与对应替换后的各个字符的长度要一致
// 将文件中所有的a替换为1,b替换为2,c替换为3
sed -i 'y/abc/123' test.txt

// 4. 匹配字串
// 将最后一行所有的 数字 替换为 b
sed -i '$s/\b[0-9]/b/g' demo.txt //[0-9] 一位数字
sed -i '$s/\b[0-9]\{2\}/b/g' demo.txt //[0-9] 2位数字
sed -i '$s/\(s1\|s2\)/b/g' demo.txt //s1 或 s2
```

## 文本分析-awk

AWK 是一种处理文本文件的语言，是一个强大的文本分析工具。

```sh
# 每行按空格或TAB分割，输出文本中的1、4项
awk '{print $1,$4}' log.txt
# 使用,分割;-F相当于内置变量FS, 指定分割字符
awk -F, '{print $1,$2}'   log.txt
# -v 设置变量
awk -va=1 '{print $1,$1+a}' log.txt
```

## 文本编辑-vi

### 模式

```sh
Esc 从insert切换到指令模式
i: insert 从光标所在处前面一个字母开始输入
I: 光标移动到这一行的最开头，并且成为书写模式
a: append 从光标所在处后面一个字母开始输入
A: 光标移动到这一行的最᳿尾，并且成为书写模式
o: open a new line 从你光标所在的当前行，下面新开一行，并且成为书写模式
O: 从你光标所在的当前行，上面新开一行，并且成为书写模式。
```

### 指令

```
:q  退出(不保存)
:q! 强制退出
:w  保存
:wq 保存后退出
```

### 查找

```bash
/字符串
n 继续向下搜索
N 继续向上搜索

# 转义\/,查找的字符串包含 / 需要转义 \/。
```

### 替换

```sh
:%s/str1/str2/g  # 全局str1替换s
```

### 行号

```
:set number 显示行号
:set nonumber 不显示行号
```

### 光标

```
G: 					 光标移动到最后一行
<数字>G: 			   光标移动到指定行
w/W: 				光标会一个词一个词往前跳
<数字>w/W: 		   光标会向前跳<数字>个词
“h”: 				光标左移 (与左尖头相同)
“l”(小写的 L): 	  光标右移 (与右尖头相同)
“j”: 				光标下移 (与向下尖头相同)
“k”: 				光标上移 (与向上尖头相同)
$ :                 光标移动到本行末尾
^ :                 光标移动到本行开始
```

### 删除

```
d^ :                 删除从光标处到本行开始之间的文字
d$ :                 删除从光标处到本行末尾之间的文字
dw :                 删除一个单词/删除光标处到单词末尾
d<5>w :              删除5个单词
dd :                 删除当前行。
d3d :				删除当前行和下面两行。
:3,5d :				删除第三行到第五行。
$:3,$d :			删除第三行到该文章的末尾。请注意，
```

### 复制/粘贴

```
:3,5y : 复制第三行到第五行
yy : 复制当前行
y3y : 复制一下3行
P/p :  粘贴到光标的前面/后面
```

## 文本编辑-vim

### 常用命令

`:set nu` 显示行数
`yy` 复制
`dd` 剪切
`p` 黏贴
`ddp` 交换上下文
`u` 撤销
`>>` 缩进
`Shift+zz` 即可保存退出 vim
`/foo` +`n` 搜索后按`n` 继续搜索

### 普通模式

`Esc`或者`Ctrl+[` 进入普通模式

**删除,黏贴等**

| 命令                 | 说明                                                               |
| :------------------- | :----------------------------------------------------------------- |
| `x` 与 `X`           | 向后 / 向前删除                                                    |
| `dd`                 | 删除整行                                                           |
| `2dd`                | 重复 dd 两次                                                       |
| `d1G` 与`dG`         | 删除到文档结尾处(首部)                                             |
| `d0` 与 `d$`         | 光标所在位置删除至行首 (行尾)                                      |
| `p` 与 `P`           | 粘贴至光标下一行 (上一行)                                          |
| `J`                  | 将光标所在列与下一列合并                                           |
| `[Ctrl]+r`           | 重复前一个动作                                                     |
| `nyy`                | 复制多行 n 为复制行数 ,在 p 进行粘贴                               |
| `ctrl+v` + `y` + `p` | 区块复制 按下`ctrl+v` 后移动移动光标选中位置,在按下`y`复制 `p`粘贴 |

**行间跳转**

| 命令            | 说明               |
| :-------------- | :----------------- |
| `nG(n Shift+g)` | 游标移动到第 n 行  |
| `gg`            | 游标移动到到第一行 |
| `G(Shift+g)`    | 到最后一行         |

**`Ctrl+o`返回跳转前的位置**

**行内跳转**

| 命令        | 说明                                             |
| :---------- | :----------------------------------------------- |
| `H`/`L`/`M` | 页首, 中页尾 , 中间                              |
| `w`         | 到下一个单词的开头                               |
| `e`         | 到当前单词的结尾                                 |
| `0`或`^`    | 到行头                                           |
| `$`         | 到行尾                                           |
| `f<字母>`   | 向后搜索<字母>并跳转到第一个匹配的位置(非常实用) |
| `F<字母>`   | 向前搜索<字母>并跳转到第一个匹配的位置           |

**替换**

| 命令             | 说明                                         |
| :--------------- | :------------------------------------------- |
| `r+<待替换字母>` | 将游标所在字母替换为指定字母                 |
| `R`              | 连续替换，直到按下 Esc                       |
| `cc`             | 替换整行，即删除游标所在行，并进入插入模式   |
| `cw`             | 替换一个单词，即删除一个单词，并进入插入模式 |
| `C(大写)`        | 替换游标以后至行末                           |
| `~`              | 反转游标所在字母大小写                       |
| `u{n}`           | 撤销一次或 n 次操作                          |
| `U(大写)`        | 撤销当前行的所有修改                         |

**查找**

| 命令             | 说明                |
| :--------------- | :------------------ |
| `/foo` 与 `?foo` | 向下 (上) 搜索      |
| `n` 与 `N`       | 继续搜索 / 反向搜索 |

### 插入模式

**进入插入模式**

| 命令       | 说明                       |
| :--------- | :------------------------- |
| `i` 与`a`  | 在当前光标 处(后 )进行编辑 |
| `I` 与 `A` | 在行 首(末) 插入           |
| `o` 与 `O` | 在当前行后(前)插入一个新行 |
| `cw`       | 替换选中的一个单词         |

---

### 命令模式

**调整文本位置**

| 命令  | 说明       |
| :---- | :--------- |
| `:ce` | 行文本居中 |
| `:ri` | 行文本靠中 |
| `:le` | 行文本靠左 |

### 替换文字

| 命令                    | 说明                                                |
| :---------------------- | :-------------------------------------------------- |
| `%s/vivian/sky/g`       | 替换每一行中所有 vivian 为 sky                      |
| `s/vivian/sky/g`        | 替换当前行所有 vivian 为 sky                        |
| `:n1,n2s/word1/word2/g` | 替换 n1 行到 n2 行 的文字 如 `:100,200s/name/age/g` |
| `:1,$s/word1/word2/g`   | 第一行到最后一行的文字                              |
| `:1,$s/word1/word2/gc`  | 加 c ,在替换前询问                                  |

### 多文件编辑

| 命令                  | 说明                             |
| :-------------------- | :------------------------------- |
| `vim 1.txt 2.txt`     | 打开多文件-                      |
| `:n` 与 `:N`          | 向后 向前切换文件-               |
| `:e 3.txt`            | 打开新文件 3.txt-                |
| `e#`                  | 回到前一个文件                   |
| `ls`                  | 可以列出以前编辑过的文档         |
| `b 2.txt（或者编号）` | 可以直接进入文件 2.txt 编辑      |
| `f`                   | 显示正在编辑的文件名             |
| `f new.txt`           | 改变正在编辑的文件名字为 new.txt |

> 多文件下可以相互复制黏贴

### 视窗操作

| 命令         | 说明                                                                |
| :----------- | :------------------------------------------------------------------ |
| `:new`       | 打开一个新的 vim 视窗                                               |
| `Ctrl+w`     | 切换                                                                |
| `:sp 1.txt`  | 开新的水平分屏视窗来编辑 1.txt                                      |
| `:vsp 2.txt` | 打开新的垂直分屏视窗来编辑 2.txt                                    |
| `Ctrl+w s`   | 将当前窗口分割成两个水平的窗口                                      |
| `Ctrl+w v`   | 将当前窗口分割成两个垂直的窗口                                      |
| `Ctrl+w q`   | 即 :q 结束分割出来的视窗。如果在新视窗中有输入需要使用强制符！即:q! |
| `Ctrl+w o`   | 打开一个视窗并且隐藏之前的所有视窗                                  |
| `Ctrl+w j`   | 移至下面视窗,同`h`,`j`,`k`,`l`                                      |
| `Ctrl+w J`   | 将当前视窗移至下面,同`H`,`J`,`K`,`L`                                |
| `Ctrl+w -`   | 减小视窗的高度                                                      |

### vim 执行外部命令

| 命令   | 说明                                                       |
| :----- | :--------------------------------------------------------- |
| `:!ls` | 用于显示当前目录的内容                                     |
| `:!rm` | FILENAME 用于删除名为 FILENAME 的文件                      |
| `:w`   | FILENAME 可将当前 VIM 中正在编辑的文件另存为 FILENAME 文件 |

### 代码补全

在 foo.php 中

| 命令                     | 说明                       |
| :----------------------- | :------------------------- |
| `[ctrl]+x` -> `[ctrl]+o` | 代码补全                   |
| `[ctrl]+x` ->`[ctrl]+f`  | 已当前目录的文件名为关键字 |
| `[ctrl]+x` -> `[ctrl]+n` | 档案文件的内容为关键字     |

### set 设置

| 命令                           | 说明                              |
| :----------------------------- | :-------------------------------- |
| `:set nu` 与 `:set nonu`       | 显示行数 / 取消行数               |
| `:set backup` `:set nobackup ` | 修改内容后产生 `filename~` 的文件 |
| `:set`                         | 显示与系统预设不同的值            |

### 预存设置

新建`~/.vimrc`

```sh
" 显示行号
set number
" 显示标尺
set ruler
" 历史纪录
set history=1000
" 输入的命令显示出来，看的清楚些
set showcmd
" 状态行显示的内容
set statusline=%F%m%r%h%w\ [FORMAT=%{&ff}]\ [TYPE=%Y]\ [POS=%l,%v][%p%%]\ %{strftime(\"%d/%m/%y\ -\ %H:%M\")}
" 启动显示状态行1，总是显示状态行2
set laststatus=2
" 语法高亮显示
syntax on
set fileencodings=utf-8,gb2312,gbk,cp936,latin-1
set fileencoding=utf-8
set termencoding=utf-8
set fileformat=unix
set encoding=utf-8
" 配色方案
colorscheme desert
" 指定配色方案是256色
set t_Co=256

set wildmenu
" 去掉有关vi一致性模式，避免以前版本的一些bug和局限，解决backspace不能使用的问题
set nocompatible
set backspace=indent,eol,start
set backspace=2

" 启用自动对齐功能，把上一行的对齐格式应用到下一行
set autoindent

" 依据上面的格式，智能的选择对齐方式，对于类似C语言编写很有用处
set smartindent

" vim禁用自动备份
set nobackup
set nowritebackup
set noswapfile

" 用空格代替tab
set expandtab

" 设置显示制表符的空格字符个数,改进tab缩进值，默认为8，现改为4
set tabstop=4

" 统一缩进为4，方便在开启了et后使用退格(backspace)键，每次退格将删除X个空格
set softtabstop=4

" 设定自动缩进为4个字符，程序中自动缩进所使用的空白长度
set shiftwidth=4

" 设置帮助文件为中文(需要安装vimcdoc文档)
set helplang=cn

" 显示匹配的括号
set showmatch

" 文件缩进及tab个数
au FileType html,python,vim,javascript setl shiftwidth=4
au FileType html,python,vim,javascript setl tabstop=4
au FileType java,php setl shiftwidth=4
au FileType java,php setl tabstop=4
" 高亮搜索的字符串
set hlsearch

" 检测文件的类型
filetype on
filetype plugin on
filetype indent on

" C风格缩进
set cindent
set completeopt=longest,menu

" 功能设置

" 去掉输入错误提示声音
set noeb
" 自动保存
set autowrite
" 突出显示当前行
" set cursorline

"设置光标样式为竖线vertical bar
 "Change cursor shape between insert and normal mode in iTerm2.app
"if $TERM_PROGRAM =~ "iTerm"
let &t_SI = "\<Esc>]50;CursorShape=1\x7" " Vertical bar in insert mode
let &t_EI = "\<Esc>]50;CursorShape=0\x7" " Block in normal mode
"endif
" 共享剪贴板
set clipboard+=unnamed
" 文件被改动时自动载入
set autoread
" 顶部底部保持3行距离
set scrolloff=3
```
